<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Створення продукту</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        label { display: block; margin-top: 10px; }
        input, textarea { width: 300px; padding: 5px; }
        button { margin-top: 15px; padding: 10px 15px; }
        #message { margin-top: 15px; font-weight: bold; }
        .error { color: red; }
        .success { color: green; }
    </style>
</head>
<body>

<h1>Створення продукту</h1>
  <a href="https://fetchtest-oc9k.onrender.com/lproductList.html">Таблица продуктов</a>
   <a href="https://fetchtest-oc9k.onrender.com/create.product.html">Создание продуктов</a>
    <a href="https://fetchtest-oc9k.onrender.com/productById.html">Продукт по ID</a>

<form id="productForm">
    <label>Назва*: <input type="text" name="name" required></label>
    <label>Опис: <textarea name="description"></textarea></label>
    <label>Ціна*: <input type="number" step="0.01" name="price" required></label>
    <label>Короткий опис: <input type="text" name="shortDescription"></label>
    <label>Категорія*: <input type="text" name="category" required></label>
    <label>Кількість*: <input type="number" name="quantity" min="0" required></label>
    <label>Бренд: <input type="text" name="brand"></label>
    <button type="submit">Створити продукт</button>
</form>

<div id="message"></div>

<script>
async function createProduct(productData) {
    try {
        const response = await fetch('/api/products', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(productData)
        });

        if (!response.ok) {
            const errorData = await response.json();
            throw errorData; // Бросаем JSON ошибок
        }

        const createdProduct = await response.json();
        return createdProduct;

    } catch (error) {
        throw error;
    }
}

document.getElementById('productForm').addEventListener('submit', async function (event) {
    event.preventDefault();

    const formData = new FormData(event.target);
    const productData = Object.fromEntries(formData.entries());
    productData.price = parseFloat(productData.price);
    productData.quantity = parseInt(productData.quantity, 10);

    const messageEl = document.getElementById('message');
    messageEl.textContent = '';
    messageEl.className = '';

    try {
        const createdProduct = await createProduct(productData);
        messageEl.textContent = '✅ Продукт успішно створено! ID: ' + createdProduct.id;
        messageEl.className = 'success';
    } catch (error) {
        messageEl.textContent = '❌ Помилка: ' + JSON.stringify(error);
        messageEl.className = 'error';
    }
});
</script>

</body>
</html>
